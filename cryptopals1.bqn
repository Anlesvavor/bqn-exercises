#"Constants"
hexDict â† (('0'+â†•10) âˆ¾ ('a'+â†•6))
base64Dict â† (('A'+â†•26) âˆ¾ ('a'+â†•26) âˆ¾ ('0'+â†•10) âˆ¾ "+/")
englishDict â† (('A'+â†•26) âˆ¾ ('a'+â†•26) âˆ¾ ('0'+â†•10) âˆ¾" '")

#Functions
ToASCII â† (-@-âŠ¢)Â¨
IntDiv â† âŒŠâˆ˜Ã·
Chunk â† âŒŠâˆ˜Ã·ËœâŸœ(â†•â‰ )âŠ”âŠ¢
ToDec â† +Â´Ã—âŸœ(2â‹†âŸœâ†•â‰ )â—‹âŒ½
ToBase â† {
  r â† ğ•¨ {ğ•¨>0 ? ((ğ•¨ IntDiv ğ•©) ğ•Š ğ•©) âˆ¾ (ğ•¨|Ëœğ•©) ; â†•0} ğ•©
  {(â‰ ğ•©)=0 ? âŸ¨0âŸ© ; ğ•©} r
}
BitsToDec â† {
  +ËË˜((2â‹†âŒ½â†•ğ•¨)Ã—âŠ¢)Ë˜(âˆ˜â€¿ğ•¨â¥Šğ•©)
}
HexToBitstring â† {
  lettersMask â† 'a' â‰¤â—‹ToASCII ğ•©
  numbersMask â† 1â‰ lettersMask
  temp1 â† numbersMask Ã— âŸœ (((ToASCII '0') -Ëœ âŠ¢)) (ToASCII ğ•©)
  temp2 â† lettersMask Ã— âŸœ (10+âŠ¢)(((ToASCII 'a') -Ëœ âŠ¢)) (ToASCII ğ•©)
  bitstringTemp â† {(ğ•© ToBase 2)}Â¨ (temp1 + temp2)
  bitString â† âˆ¾Â´{Â¯4â†‘ğ•©}Â¨ bitstringTemp
  bitString
}
HexToBase64 â† {
  (base64DictâŠ‘ËœâŠ¢)Â¨ (6 BitsToDec (HexToBitString ğ•©))
}
FixedXOR â† (hexDictâŠ‘ËœâŠ¢)Â¨âˆ˜(4 BitsToDecâŠ¢)âˆ˜â‰ â—‹HexToBitString
HexToString â† {(@+ToDec)Ë˜(âˆ˜â€¿8â¥ŠHexToBitstring ğ•©)}

ex1 â† {
  h â† "49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d"
  â€¢Show HexToBase64 h
  !("SSdtIGtpbGxpbmcgeW91ciBicmFpbiBsaWtlIGEgcG9pc29ub3VzIG11c2hyb29t" â‰¡ HexToBase64 h)
  !("I'm killing your brain like a poisonous mushroom" â‰¡ HexToString h)
}

ex2 â† {
  a â† "1c0111001f010100061a024b53535009181c"
  b â† "686974207468652062756c6c277320657965"
  â€¢Show a FixedXOR b
  !("746865206b696420646f6e277420706c6179" â‰¡ a FixedXOR b)
  PlainTextScore â† {
    m â† ("etaon rishdlfcmugypwbvkjxzq'ETAONRISHDLFCMUGYPWBVKJXZQ") âŠ ğ•©
    +Â´ m
  }
}

SingleByteXOR â† {
  mysteryText â† ğ•©
  testBytes â† ((Â¯8â†‘âŠ¢)(2 ToBaseËœ âŠ¢))Â¨ â†•(2â‹†8)
  mysteryBytes â† <âˆ˜âˆ¾Ë˜(âˆ˜â€¿2 â¥Š (4 Chunk âŠ¢)(HexToBitstring mysteryText))
  table â† (testBytes â‰ âŒœ mysteryBytes)
  tableOfBits â† (8 Chunk âŠ¢)âˆ˜âˆ¾Ë˜table
  tableOfStrings â† @+ToDecÂ¨ tableOfBits
  âŠ¢ strings â† â¥Š<Ë˜tableOfStrings
}

PlainTextScore â† {
  m â† ("etaon rishdlfcmugypwbvkjxzq'ETAONRISHDLFCMUGYPWBVKJXZQ") âŠ ğ•©
  +Â´ m
}

ex3 â† {
  mysteryText â† "1b37373331363f78151b7f2b783431333d78397828372d363c78373e783a393b3736"
  strings â† SingleByteXOR mysteryText
  scores â† PlainTextScoreÂ¨ strings
  bestsIndex â† âŠ‘âŠâŸœ(âŒŠÂ´) scores
  â€¢Show bestsIndex âŠ‘âˆ˜âŠ strings
}

ex4 â† {
  lines â† â€¢file.Lines "4.txt"
  F â† {
    strings â† SingleByteXOR ğ•©
    scores â† PlainTextScoreÂ¨ strings
    bestsIndex â† âŠ‘âŠâŸœ(âŒŠÂ´) scores
    bestsIndex âŠ‘âˆ˜âŠ strings
  }
  results â† FÂ¨ lines
  scores â† PlainTextScoreÂ¨ results
  bestsIndex â† âŠ‘âŠâŸœ(âŒŠÂ´) scores
  â€¢Show bestsIndex âŠ‘âˆ˜âŠ results
}
